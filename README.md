                
# Privacy Attacks in Decentralized Learning

This repository contains the Python implementation of the paper [Privacy Attacks in Decentralized Learning](https://arxiv.org/abs/2402.10001).

## Citation
Please cite this paper if you use our code.

```
@inproceedings{decattack,
    author = {Mrini,  Abdellah El and Cyffers,  Edwige and Bellet,  Aurélien},
  keywords = {Machine Learning (cs.LG),  Cryptography and Security (cs.CR),  FOS: Computer and information sciences,  FOS: Computer and information sciences},
  title = {Privacy Attacks in Decentralized Learning},
  booktitle={International Conference on Machine Learning},
  year={2024},
  organization={PMLR}
}
```




## Usage

To clone the repository, use the following command :
```
git clone --recurse-submodules https://github.com/AbdellahElmrini/decAttack.git
```
## Requirements

To install requirements:

```setup
pip install -r requirements.txt
```


## Organization
The main part of the project are contained in
- `consensus.py` contains the class Reconstruct and define the main primitives needed
- `utils.py` contains some functions to manipulate graph easily
- `rref.py` contains an implementation of RREF decomposition
- `decentralized.py` contains an implementation of decentralized gradient descent in the presence of attackers
- `optim.py` contains an implementation of the attack 


## To reproduce the figures with consensus
- Figure 2 is obtained from running the `exp_erdos_renyi.py` that generates the experiments and then `fig2.py`
- Figure 3 require to dowload the Facebook Ego graph dataset, see below. The statistics are generated by `alltoallego.py`.Then, and the figure is done with `fig3.py`
- Table 1 and 2 report the result from the stats also generated by `alltoallego.py` but processed by `correlego.py`. The Erdös-Renyi experiments are in `correls.py`
- Figure 9 is generated by `facebook.py`

## To reproduce the figures with the decentralized attack
- Figure 4-a is obtained by running `scripts/exp_fig_4a.py` 
- Figure 4-b is obtained by running `scripts/exp_fig_4b_MNIST_line_graph.py`
- Figure 5 and figure 11 can be obtained by running `notebooks/fig5_11_Florentine.ipynb`
- Figure 6 is obtained by running `scripts/exp_fig6.py`

## Datasets
- The Facebook ego graph can be downloaded here: https://snap.stanford.edu/data/ego-Facebook.html 
